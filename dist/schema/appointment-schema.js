"use strict";const Schema=require("mongoose").Schema;var Appointment=new Schema({app_id:{type:String,required:!0,index:!0},p_id:{type:String,index:!0},appointment_date:{type:Date,required:!0},doctor:{type:String,index:!0,required:!0},status:{type:Number,default:1},// 0-Cancelled, 1-Scheduled, 2-Completed, 3-Postponed
room:Number,created_at:{type:Date,default:Date.now}});Appointment.statics.getAll=function(){return this.find({},{_id:0,__v:0}).sort("-appointment_date").lean().exec()},Appointment.statics.countAll=function(){return this.countDocuments()},Appointment.statics.getByAppid=function(a){return this.findOne({app_id:a},{_id:0,__v:0}).lean().exec()},Appointment.statics.findByPid=function(a){return this.find({p_id:a},{_id:0,__v:0}).sort("-appointment_date").lean().exec()},Appointment.statics.countByPid=function(a){return this.find({p_id:a}).countDocuments()},Appointment.statics.getLatestAppId=function(){return this.find({},{app_id:1}).sort("-created_at").limit(1).exec()},Appointment.statics.findByDoctor=function(a){return this.find({doctor:a},{_id:0,__v:0}).sort("-appointment_date").lean().exec()},Appointment.statics.countByDoctor=function(a){return this.find({doctor:a}).countDocuments()},Appointment.statics.getDistinctDoctor=function(){return this.distinct("doctor")},Appointment.statics.findBetweenDate=function(a,b){return this.find({$and:[{appointment_date:{$gte:a}},{appointment_date:{$lte:b}}]},{_id:0,__v:0}).sort("-appointment_date").lean().exec()},Appointment.statics.countBetweenDate=function(a,b){return this.find({$and:[{appointment_date:{$gte:a}},{appointment_date:{$lte:b}}]}).countDocuments()},Appointment.statics.findByStatus=function(a){return this.find({status:a},{_id:0,__v:0}).sort("-created_at").lean().exec()},Appointment.statics.countByStatus=function(a){return this.find({status:a}).countDocuments()},Appointment.statics.findByAvailability=function(a,b,c){return this.find({$and:[{appointment_date:{$gte:b}},{appointment_date:{$lte:c}},{doctor:a}]}).sort("-created_at").lean().exec()},Appointment.statics.updateDoc=function(a,b){return this.findOneAndUpdate({app_id:a},{$set:b}).exec()},Appointment.statics.deleteByAppid=function(a){return this.deleteOne({app_id:a}).exec()},module.exports=Appointment;